# colyseus authorization adapters
オンラインゲームサーバーのフレームワーク [Colyseus](https://github.com/colyseus/colyseus) の上に乗っけて使いたいと思ってる認証用ライブラリ。

Express Middlewareとして実装しています。とりあえず、名前を入れたら認証してサーバーに入れるぐらいのところができればいいかなと思ってます。アカウントとかはまた必要になったときにでも。

# 利用イメージ
## ゲームサーバとアプリケーションサーバ
俺が俺のために作ってるので、ユースケースとしてはこうです。

- 静的ファイルをさくらレンタルサーバ(アプリケーションサーバとでも言っておこう)に処理してもらう
- colyseusとこのライブラリは別のサーバ(ゲームサーバとでも言っておこう)で起動させておく。
- 具体的には、herokuとかにぶん投げておく。

## 名前で入室するケース
名前を入力したら、アプリケーションサーバからゲームサーバに向かってAPIを呼んでredisにセッションを作ります。セッションIDをブラウザに送っておきます。colyseusのルームハンドラで、 onAuth コールバックでセッションIDを受けるようにして、redisからセッションがひければ認証成功という単純な仕組みです。

2回目以降は、アプリケーションサーバがまたもやAPIを呼んでセッションを確認し、あれば直接ゲーム画面にリダイレクトしてくれるイメージです。colyseusのソケットに接続するときに、 auth パラメータにセッションIDを入れます。最初にブラウザにクッキー経由でセッションIDを送っておいたので、フロントエンドからクッキーを見てセッションIDを入れればいいはずです。
